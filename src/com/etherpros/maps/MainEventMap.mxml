<?xml version="1.0" encoding="utf-8"?>
<EventMap
	xmlns:fx="http://ns.adobe.com/mxml/2009"
	xmlns:s="library://ns.adobe.com/flex/spark" 
	xmlns="http://mate.asfusion.com/"
	>
	
	<fx:Script>
		<![CDATA[
			import com.etherpros.business.ClientDAO;
			import com.etherpros.business.ContractorDAO;
			import com.etherpros.business.JobAssignmentDAO;
			import com.etherpros.business.ProjectDAO;
			import com.etherpros.business.RigDAO;
			import com.etherpros.components.CalendarForm;
			import com.etherpros.components.JobAssignmentPopup;
			import com.etherpros.events.ClientEvent;
			import com.etherpros.events.ContractorEvent;
			import com.etherpros.events.JobAssignmentEvent;
			import com.etherpros.events.ProjectEvent;
			import com.etherpros.events.RigEvent;
			
			import mx.events.*;
			
		]]>
	</fx:Script>
	
	
	<fx:Declarations>	
		<!-- Inject properties to any views as soon as possible listening to FlexEvent.PREINITIALIZE -->
		
		<InjectorSettings eventType="{ FlexEvent.PREINITIALIZE }"/>
		
		
		<!-- Handlers for contractors events  -->
		<EventHandlers type="{ContractorEvent.FIND_ALL}" debug="true">
			<MethodInvoker generator="{ ContractorDAO }" method="findAll"  />			
		</EventHandlers>
		<!-- Handlers for projects events  -->
		<EventHandlers type="{ProjectEvent.FIND_ALL}" debug="true">
			<MethodInvoker generator="{ ProjectDAO }" method="findAll"  />			
		</EventHandlers>
		<EventHandlers type="{RigEvent.FIND_ALL}" debug="true">
			<MethodInvoker generator="{ RigDAO }" method="findAll"  />			
		</EventHandlers>
		<EventHandlers type="{ClientEvent.FIND_ALL}" debug="true">
			<MethodInvoker generator="{ ClientDAO }" method="findAll"  />			
		</EventHandlers>
		
		<EventHandlers type="{ JobAssignmentEvent.JOB_ASSIGNMENT_SAVE }" debug="true">
			<ObjectBuilder 
				generator="{ JobAssignmentDAO }"				
				constructorArguments="{ scope.dispatcher }"
				/>
			<MethodInvoker generator="{ JobAssignmentDAO }" method="createJobAssignment"  arguments="{[event.job]}"/>			
		</EventHandlers>		
		<!-- Object injectors  -->
		<Injectors target="{ CalendarForm }" debug="true">
			<ObjectBuilder 
				generator="{ ContractorDAO }"				
				constructorArguments="{ scope.dispatcher }"
				/>
			<PropertyInjector
				targetKey="contractorList"
				source="{ ContractorDAO }" 
				sourceKey="contractorList"
				/>
		</Injectors>
		<Injectors target="{ JobAssignmentPopup }" debug="true">
			<ObjectBuilder 
				generator="{ ProjectDAO }"				
				constructorArguments="{ scope.dispatcher }"
				/>
			<PropertyInjector
				targetKey="projects"
				source="{ ProjectDAO }" 
				sourceKey="projects"
				/>
		</Injectors>
		<Injectors target="{ JobAssignmentPopup }" debug="true">
			<ObjectBuilder 
				generator="{ RigDAO }"				
				constructorArguments="{ scope.dispatcher }"
				/>
			<PropertyInjector
				targetKey="rigs"
				source="{ RigDAO }" 
				sourceKey="rigs"
				/>
		</Injectors>
		<Injectors target="{ JobAssignmentPopup }" debug="true">
			<ObjectBuilder 
				generator="{ ClientDAO }"				
				constructorArguments="{ scope.dispatcher }"
				/>
			<PropertyInjector
				targetKey="clients"
				source="{ ClientDAO }" 
				sourceKey="clients"
				/>
		</Injectors>
		
	</fx:Declarations>
	
</EventMap>
